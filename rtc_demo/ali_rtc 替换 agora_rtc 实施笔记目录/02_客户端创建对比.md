# 客户端创建对比

## 客户端初始化

### Agora RTC 客户端创建

```typescript
// 需要详细配置
const client = AgoraRTC.createClient({
  mode: "rtc", // 实时通信模式，还有 "live" 直播模式
  codec: "vp8", // 视频编解码器，还有 "h264"
});

// 可选配置参数
const client = AgoraRTC.createClient({
  mode: "rtc",
  codec: "vp8",
  role: "host", // 角色：host(主播) 或 audience(观众)
});
```

### 阿里云RTC 客户端创建

```typescript
// 无需配置参数
const client = DingRTC.createClient();

// 根据源码分析，阿里云RTC的createClient方法不接受参数
// 所有配置通过其他方式设置
```

## 配置复杂度对比

| 项目       | Agora RTC    | 阿里云RTC    |
| ---------- | ------------ | ------------ |
| 必须参数   | mode, codec  | 无           |
| 可选参数   | role         | 根据文档确定 |
| 配置复杂度 | 中等         | 简单         |
| 默认行为   | 需要明确指定 | 内部自动处理 |

## 模式选择

### Agora RTC 模式

```typescript
// 实时通信模式 - 适合多人通话
mode: "rtc";

// 直播模式 - 适合一对多直播
mode: "live";
```

### 阿里云RTC 模式

```typescript
// 阿里云 RTC 内部自动选择模式
// 具体实现需要查看阿里云文档
```

## 编解码器选择

### Agora RTC 编解码器

```typescript
// VP8 编解码器 - 更好的兼容性
codec: "vp8";

// H.264 编解码器 - 更好的压缩率
codec: "h264";
```

### 阿里云RTC 编解码器

```typescript
// 阿里云 RTC 内部自动选择编解码器
// 具体实现需要查看阿里云文档
```

## 实际迁移影响

### 代码修改

```typescript
// 迁移前 - Agora RTC
const client = AgoraRTC.createClient({
  mode: "rtc",
  codec: "vp8",
});

// 迁移后 - 阿里云RTC
const client = DingRTC.createClient();
```

### playground 具体修改点

```typescript
// 文件: ai_agents/playground/src/manager/rtc/rtc.ts

// 1. 导入语句修改
// 从:
import AgoraRTC, {
  IAgoraRTCClient,
  IMicrophoneAudioTrack,
  IRemoteAudioTrack,
  UID,
} from "agora-rtc-sdk-ng";

// 到:
import DingRTC, {
  DingRTCClient,
  MicrophoneAudioTrack,
  RemoteAudioTrack,
  UID,
} from "dingrtc";

// 2. 类型定义修改
// 从:
client: IAgoraRTCClient;

// 到:
client: DingRTCClient;

// 3. 类型文件修改
// 文件: ai_agents/playground/src/manager/rtc/types.ts
// 从:
import {
  UID,
  IAgoraRTCRemoteUser,
  IAgoraRTCClient,
  ICameraVideoTrack,
  IMicrophoneAudioTrack,
  NetworkQuality,
  ILocalVideoTrack,
} from "agora-rtc-sdk-ng";

// 到:
import {
  UID,
  RemoteUser,
  DingRTCClient,
  CameraVideoTrack,
  MicrophoneAudioTrack,
  NetworkQuality,
  LocalVideoTrack,
} from "dingrtc";

// 4. 接口定义修改
// 从:
export interface IUserTracks {
  videoTrack?: ICameraVideoTrack;
  screenTrack?: ILocalVideoTrack;
  audioTrack?: IMicrophoneAudioTrack;
}

// 到:
export interface IUserTracks {
  videoTrack?: CameraVideoTrack;
  screenTrack?: LocalVideoTrack;
  audioTrack?: MicrophoneAudioTrack;
}

// 3. 客户端创建修改
// 从:
this.client = AgoraRTC.createClient({ mode: "rtc", codec: "vp8" });

// 到:
this.client = DingRTC.createClient();
```

### 配置管理

```typescript
// 迁移前 - 需要管理复杂配置
const config = {
  mode: "rtc",
  codec: "vp8",
  role: "host",
};

// 迁移后 - 配置简化
const config = {
  // 阿里云 RTC 配置（如果需要）
};
```

## 关键差异总结

### 1. 配置复杂度

- **Agora**: 需要明确指定模式和编解码器
- **阿里云**: 内部自动处理，配置简单

### 2. 控制精度

- **Agora**: 提供精细的控制选项
- **阿里云**: 提供简化的使用体验

### 3. 学习成本

- **Agora**: 需要了解各种配置参数
- **阿里云**: 开箱即用，学习成本低

### 4. 迁移要点

- 删除客户端创建时的配置参数
- 简化配置管理逻辑
- 保持功能完整性
- 更新类型定义引用
- 修改轨道创建方法调用方式

### 5. 全局事件监听对比

**Agora RTC**:

```typescript
// 设备变化事件
AgoraRTC.on("camera-changed", (info) => {
  console.log("摄像头设备变化:", info);
});

AgoraRTC.on("microphone-changed", (info) => {
  console.log("麦克风设备变化:", info);
});

AgoraRTC.on("playback-device-changed", (info) => {
  console.log("播放设备变化:", info);
});
```

**阿里云RTC**:

```typescript
// 设备变化事件 (根据[官方文档](https://help.aliyun.com/document_detail/2674351.html))
DingRTC.on("camera-changed", (info) => {
  console.log("摄像头设备变化:", info);
});

DingRTC.on("microphone-changed", (info) => {
  console.log("麦克风设备变化:", info);
});

DingRTC.on("playback-device-changed", (info) => {
  console.log("播放设备变化:", info);
});

// 自动播放失败事件
DingRTC.on("autoplay-failed", (track) => {
  console.log("自动播放失败:", track);
});
```

### 6. 配置管理对比

**Agora RTC**:

```typescript
// 设置日志级别
AgoraRTC.setLogLevel(AgoraRTC.LOG_LEVEL.INFO);
```

**阿里云RTC**:

```typescript
// 设置日志级别
DingRTC.setLogLevel("info");

// 设置客户端配置
DingRTC.setClientConfig({
  // 配置参数
});
```
