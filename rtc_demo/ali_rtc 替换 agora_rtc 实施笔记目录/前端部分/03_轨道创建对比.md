# 轨道创建对比

## 音频轨道创建

### Agora RTC 音频轨道

```typescript
// 使用静态方法创建
this.localAudioTrack = await AgoraRTC.createMicrophoneAudioTrack({
  encoderConfig: "music_standard",
  AEC: true,
  AGC: true,
  ANS: true,
});

// 基础配置
this.localAudioTrack = await AgoraRTC.createMicrophoneAudioTrack({
  encoderConfig: "speech_standard",
});
```

### 阿里云RTC 音频轨道

```typescript
// 使用静态方法创建（与Agora一致）
this.localAudioTrack = await DingRTC.createMicrophoneAudioTrack();

// 支持配置参数
this.localAudioTrack = await DingRTC.createMicrophoneAudioTrack({
  deviceId: micId, // 设备ID
  // 其他音频配置选项
});

// 同时创建音频和视频轨道（阿里云特有功能）
const [videoTrack, audioTrack] = await DingRTC.createMicrophoneAndCameraTracks(
  videoConfig, // 视频配置
  audioConfig  // 音频配置
);
```

## 视频轨道创建

### Agora RTC 视频轨道

```typescript
// 使用静态方法创建
this.localVideoTrack = await AgoraRTC.createCameraVideoTrack({
  encoderConfig: "1080p_1",
});

// 基础配置
this.localVideoTrack = await AgoraRTC.createCameraVideoTrack({
  encoderConfig: "720p_1",
});
```

### 阿里云RTC 视频轨道

```typescript
// 使用静态方法创建（与Agora一致）
this.localVideoTrack = await DingRTC.createCameraVideoTrack();

// 支持配置参数
this.localVideoTrack = await DingRTC.createCameraVideoTrack({
  deviceId: cameraId, // 设备ID
  dimension: 'VD_640x480', // 视频尺寸
  frameRate: 15, // 帧率
  // 其他视频配置选项
});
```

## 轨道创建方式对比

| 项目     | Agora RTC         | 阿里云RTC    |
| -------- | ----------------- | ------------ |
| 创建方式 | 静态方法          | 静态方法     |
| 配置参数 | 丰富的配置选项    | 简化的配置   |
| 编码配置 | 需要明确指定      | 内部自动优化 |
| 音频处理 | 支持AEC、AGC、ANS | 内部自动处理 |

## 关键迁移差异

### 1. 创建方法差异

```typescript
// Agora RTC - 静态方法
const audioTrack = await AgoraRTC.createMicrophoneAudioTrack();
const videoTrack = await AgoraRTC.createCameraVideoTrack();

// 阿里云RTC - 静态方法（与Agora一致）
const audioTrack = await DingRTC.createMicrophoneAudioTrack();
const videoTrack = await DingRTC.createCameraVideoTrack();

// 阿里云RTC - 同时创建音视频轨道（特有功能）
const [videoTrack, audioTrack] = await DingRTC.createMicrophoneAndCameraTracks(
  videoConfig,
  audioConfig
);
```

### 2. 配置参数差异

```typescript
// Agora RTC - 详细配置
const audioTrack = await AgoraRTC.createMicrophoneAudioTrack({
  encoderConfig: "music_standard",
  AEC: true,
  AGC: true,
  ANS: true,
});

// 阿里云RTC - 支持配置参数
const audioTrack = await DingRTC.createMicrophoneAudioTrack({
  deviceId: micId, // 设备ID
  // 其他音频配置参数
});

// 阿里云RTC - 同时创建音频和视频轨道（特有功能）
const [videoTrack, audioTrack] = await DingRTC.createMicrophoneAndCameraTracks(
  { dimension: 'VD_640x480', frameRate: 15 }, // 视频配置
  { deviceId: micId } // 音频配置
);
```

### 3. 轨道类型对比

**Agora RTC轨道类型**:

- `ICameraVideoTrack` - 摄像头视频轨道
- `IMicrophoneAudioTrack` - 麦克风音频轨道
- `ILocalVideoTrack` - 本地视频轨道
- `ILocalAudioTrack` - 本地音频轨道

**阿里云RTC轨道类型** (根据[官方文档](https://help.aliyun.com/document_detail/2674346.html)):

- `CameraVideoTrack` - 摄像头视频轨道
- `MicrophoneAudioTrack` - 麦克风音频轨道
- `LocalVideoTrack` - 本地视频轨道
- `LocalAudioTrack` - 本地音频轨道
- `CustomVideoTrack` - 自定义视频轨道
- `CustomAudioTrack` - 自定义音频轨道

## 编码配置对比

### Agora RTC 编码配置

```typescript
// 音频编码配置
const audioConfig = {
  encoderConfig: "music_standard", // 音乐标准
  AEC: true, // 回声消除
  AGC: true, // 自动增益控制
  ANS: true, // 噪声抑制
};

// 视频编码配置
const videoConfig = {
  encoderConfig: "1080p_1", // 1080p分辨率
};
```

### 阿里云RTC 编码配置

```typescript
// 阿里云 RTC 内部自动优化编码配置
// 具体配置参数需要查看阿里云文档
```

## 轨道属性对比

### Agora RTC 轨道属性

```typescript
// 轨道类型
interface IMicrophoneAudioTrack {
  trackMediaType: "audio";
  enabled: boolean;
  muted: boolean;
}

interface ICameraVideoTrack {
  trackMediaType: "video";
  enabled: boolean;
  muted: boolean;
}
```

### 阿里云RTC 轨道属性

```typescript
// 轨道类型
interface MicrophoneAudioTrack {
  trackMediaType: "audio";
  enabled: boolean;
  muted: boolean;
}

interface CameraVideoTrack {
  trackMediaType: "video";
  enabled: boolean;
  muted: boolean;
}
```

## 实际迁移影响

### 代码修改

```typescript
// 迁移前 - Agora RTC
this.localAudioTrack = await AgoraRTC.createMicrophoneAudioTrack({
  encoderConfig: "music_standard",
  AEC: true,
  AGC: true,
  ANS: true,
});

this.localVideoTrack = await AgoraRTC.createCameraVideoTrack({
  encoderConfig: "1080p_1",
});

// 迁移后 - 阿里云RTC
this.localAudioTrack = await DingRTC.createMicrophoneAudioTrack();
this.localVideoTrack = await DingRTC.createCameraVideoTrack();
```

### playground 具体修改点

```typescript
// 文件: ai_agents/playground/src/manager/rtc/rtc.ts

// 1. 轨道创建方法修改
// 从:
async createCameraTracks() {
  try {
    const videoTrack = await AgoraRTC.createCameraVideoTrack();
    this.localTracks.videoTrack = videoTrack;
  } catch (err) {
    console.error("Failed to create video track", err);
  }
  this.emit("localTracksChanged", this.localTracks);
}

async createMicrophoneAudioTrack() {
  try {
    const audioTrack = await AgoraRTC.createMicrophoneAudioTrack();
    this.localTracks.audioTrack = audioTrack;
  } catch (err) {
    console.error("Failed to create audio track", err);
  }
  this.emit("localTracksChanged", this.localTracks);
}

// 到:
async createCameraTracks() {
  try {
    const videoTrack = await DingRTC.createCameraVideoTrack();
    this.localTracks.videoTrack = videoTrack;
  } catch (err) {
    console.error("Failed to create video track", err);
  }
  this.emit("localTracksChanged", this.localTracks);
}

async createMicrophoneAudioTrack() {
  try {
    const audioTrack = await DingRTC.createMicrophoneAudioTrack();
    this.localTracks.audioTrack = audioTrack;
  } catch (err) {
    console.error("Failed to create audio track", err);
  }
  this.emit("localTracksChanged", this.localTracks);
}

// 2. 屏幕共享轨道创建修改
// 从:
async createScreenShareTrack() {
  try {
    const screenTrack = await AgoraRTC.createScreenVideoTrack({
      encoderConfig: {
        width: 1200,
        height: 800,
        frameRate: 5
      }
    }, "disable");
    this.localTracks.screenTrack = screenTrack;
  } catch (err) {
    console.error("Failed to create screen track", err);
  }
  this.emit("localTracksChanged", this.localTracks);
}

// 到:
async createScreenShareTrack() {
  try {
    // 重要差异：阿里云 DingRTC 的 createScreenVideoTrack 返回数组
    const screenTracks = await DingRTC.createScreenVideoTrack({
      dimension: {
        width: 1200,
        height: 800,
        frameRate: 5
      }
    });
    // 取第一个轨道
    this.localTracks.screenTrack = screenTracks[0];
  } catch (err) {
    console.error("Failed to create screen track", err);
  }
  this.emit("localTracksChanged", this.localTracks);
}
```

### 配置简化

```typescript
// 迁移前 - 需要管理复杂配置
const audioConfig = {
  encoderConfig: "music_standard",
  AEC: true,
  AGC: true,
  ANS: true,
};

const videoConfig = {
  encoderConfig: "1080p_1",
};

// 迁移后 - 配置简化
// 阿里云 RTC 内部自动处理配置
```

## 关键差异总结

### 1. 创建方式

- **Agora**: 使用静态方法 `AgoraRTC.createMicrophoneAudioTrack()`
- **阿里云**: 使用静态方法 `DingRTC.createMicrophoneAudioTrack()`（与Agora一致）
- **阿里云特有**: 支持 `DingRTC.createMicrophoneAndCameraTracks()` 同时创建音视频轨道

### 2. 配置复杂度

- **Agora**: 需要详细配置编码参数
- **阿里云**: 内部自动优化，配置简单

### 3. 音频处理

- **Agora**: 支持AEC、AGC、ANS等高级功能
- **阿里云**: 内部自动处理音频优化

### 4. 迁移要点

- 修改轨道创建方法调用
- 删除复杂的编码配置
- 保持轨道属性的一致性
- 简化配置管理逻辑
